.\" Manpage for repo-pack
.\" Contact Raul Almeida <contato@acolita.com.br> to correct errors or typos.
.TH repo-pack 1 "March 2024" "1.0.0" "repo-pack Manual"
.SH NAME
repo-pack \- Flatten and restore directory structures into a single text file
.SH SYNOPSIS
.B repo-pack
[\fIOPTIONS\fR] \fISource_dir\fR
.br
.B repo-pack
.B \-x
[\fIOPTIONS\fR] \fIArchive_file\fR
.SH DESCRIPTION
.B repo-pack
is a command-line tool that flattens a directory (like a Git repository) into a single, portable text file. It preserves directory structure and text file contents, including SHA-256 checksums for integrity verification.
.PP
It automatically detects and skips binary files using libmagic. The output format is human-readable and suitable for processing by other tools or large language models.
.PP
In packing mode (default), it reads the \fISource_dir\fR, skips the .git directory, identifies text files, calculates their SHA-256 hashes, and writes a structured archive to standard output.
.PP
In extraction mode (\fB\-x\fR), it reads an \fIArchive_file\fR (or standard input if \fIArchive_file\fR is \fB-\fR), parses the header, recreates the directory structure in the specified output directory, extracts the files, and optionally verifies their integrity using SHA-256 hashes.
.SH OPTIONS
.TP
.B \-x\fR, \fB\-\-extract\fR
Switch to extraction mode. Requires an archive file as input.
.TP
.BI \-o\fR " PATH\fR", " \fB\-\-output\fR=\fIPATH\fR"
Specify the output directory for extraction. Defaults to the current directory. Created if it doesn't exist. Ignored in packing mode.
.TP
.B \-v\fR, \fB\-\-verbose\fR
Enable verbose output, showing steps being taken and detailed information.
.TP
.B \-\-verify\fR
During extraction (\fB\-x\fR mode), verify the SHA-256 checksum of each restored file against the checksum stored in the archive header. Reports errors for mismatches. Ignored in packing mode.
.TP
.B \-\-skip-bin\fR
During packing mode, silently skip binary files without printing a warning to stderr. Warnings are shown by default. Ignored in extraction mode.
.TP
.B \-h\fR, \fB\-\-help\fR
Show usage information and exit.
.SH EXAMPLES
.PP
Pack the directory 'myproject' into 'project.pack':
.RS
.nf
\fBrepo-pack myproject > project.pack\fR
.fi
.RE
.PP
Pack the current directory, suppressing binary warnings:
.RS
.nf
\fBrepo-pack --skip-bin . > current_dir.pack\fR
.fi
.RE
.PP
Extract 'backup.pack' into a new directory 'restored_proj', verifying checksums:
.RS
.nf
\fBmkdir restored_proj\fR
\fBrepo-pack -x backup.pack -o restored_proj --verify\fR
.fi
.RE
.PP
Extract an archive piped from curl:
.RS
.nf
\fBcurl -s http://example.com/data.pack | repo-pack -x - -o ./data_dir\fR
.fi
.RE
.SH FILES
The archive file generated by \fBrepo-pack\fR is a plain text file containing a header section with metadata and file listings, followed by a content section with the concatenated contents of the packed text files.
.SH SEE ALSO
.BR magic (1),
.BR sha256sum (1),
.BR tar (1),
.BR git (1)
.SH AUTHOR
Raul Almeida <contato@acolita.com.br>